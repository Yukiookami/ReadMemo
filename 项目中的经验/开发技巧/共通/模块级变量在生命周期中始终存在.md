# 模块级变量在生命周期中始终存在

## 模块级变量被视为单例，它会在整个应用的生命周期中保留

### 模块的加载和执行

应用程序首次运行并导入模块时，JavaScript 引擎会加载并执行该模块的代码。这意味着模块中的顶层代码（不在任何函数或类内部的代码）会被执行一次。

### 模块的缓存

一旦模块被加载并执行后，JavaScript 模块系统会将该模块的导出内容（包括变量、函数、类等）缓存起来。这个缓存是基于模块的文件路径或标识符的，全局唯一。

### 单例模式

由于模块被缓存，后续任何对该模块的导入都会引用同一个模块实例。也就是说，模块 a 中的变量在整个应用程序中是共享的，并且只有一个实例。这就类似于单例模式（Singleton）。

### 状态的持久性

当页面 b 中修改了模块 a 的变量，这个修改会直接影响到模块 a 的实例。由于模块 a 的实例在应用程序的生命周期内不会被卸载或重新初始化，所以这些修改会一直保留。

### 导航不影响模块状态

在单页应用（SPA）中，页面的导航（从 b 到 c，再返回到 b）通常不会导致页面的完全刷新，也不会重新加载 JavaScript 模块。因此，模块 a 的状态不会因为页面跳转而重置。

## 模块级变量的生命周期

模块级变量的生命周期始终与应用程序的生命周期保持一致。这意味着**模块级变量在整个应用程序的生命周期中始终存在，直到应用程序被卸载或关闭。**

## 模块级变量的特性带来的影响

模块级变量的持久性会对开发带来一些意想不到的问题，尤其是数据污染最为明显，**当模块级变量为引用类型，并且在页面中使用的时候进行了浅拷贝，就会无意识的修改掉模块变量。导致画面的表现出现问题或者数据的值超出预期。**

**所以在使用模块级数据的时候，一定不要随意修改，如果需要修改，一定要进行深拷贝。**
