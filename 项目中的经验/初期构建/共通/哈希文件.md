# 哈希文件

## 哈希文件是什么

哈希文件是指在文件名后面加上哈希值，用于解决浏览器缓存问题。

## 哈希文件的作用

- 缓存优化

  - **浏览器缓存:** 现代浏览器会缓存静态资源以提高加载速度。但当文件内容更新时，浏览器可能会继续使用旧的缓存版本，导致用户无法及时获取最新的资源。
  - **解决方案：**通过在文件名中添加哈希值，文件名会随着内容变化而改变，从而强制浏览器重新下载最新版本的资源，避免缓存问题。

- 缓存破坏

  - **缓存破坏:** 当文件内容没有发生变化时，文件名发生变化会导致浏览器重新下载资源，增加了网络请求，降低了性能。

- 资源管理

  - **资源管理:** 当文件内容发生变化时，哈希值也会随之变化。这种机制确保了用户总是加载到最新的资源，而不会因为缓存而使用旧版本。

## 如何配置哈希文件

一般来说哈希文件是构建工具自己生成，不需要额外配置。

例如，webpack 会在打包时自动生成哈希文件，如下所示：

```js
// webpack.config.js
module.exports = {
  output: {
    filename: "[name].[contenthash].js",
  },
};
```

在上面的配置中，`[contenthash]` 会根据文件内容生成哈希值，当文件内容发生变化时，哈希值也会发生变化，从而强制浏览器重新下载最新的资源。

在 vite 中，则是

```js
// vite.config.js
export default defineConfig({
  build: {
    rollupOptions: {
      output: {
        entryFileNames: "[name]-[hash].js",
        chunkFileNames: "[name]-[hash].js",
        assetFileNames: "[name]-[hash].[ext]",
      },
    },
  },
});
```

## 总结

哈希文件是一种解决浏览器缓存问题的方法，通过在文件名中添加哈希值，确保用户总是加载到最新的资源。但是，哈希文件也会增加网络请求，降低性能，因此需要权衡利弊，根据实际情况选择是否使用哈希文件。
